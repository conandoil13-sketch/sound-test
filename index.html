<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>Data Roguelike RPG â€” PIXIE</title>
    <link rel="stylesheet" href="./src/style.css">
    <link rel="stylesheet" href="./src/story-bubble.css">

</head>

<body>
    <!-- ìƒë‹¨ HUD -->
    <header class="topbar">
        <div class="left">
            <span id="floor">F1-Î±</span>
            <span id="fidelity" aria-label="fidelity level">L0</span>
            <span id="exitHint" hidden>Exit?</span>
        </div>
        <div class="right">
            <!-- â–¼ ì´ ë²„íŠ¼ì´ PIXIE ë¡œê·¸ ì—´ê¸° ë²„íŠ¼ì„ ê²¸í•¨ -->
            <button id="pixieBtn" class="icon" aria-controls="logSheet" aria-expanded="false"
                title="PIXIE ê¸°ë¡ ì—´ê¸°">ğŸ¤–</button>
            <span id="gold">0G</span>
        </div>
    </header>

    <!-- ì»¨í…ì¸ : ë°© ì¹´ë“œ + ì „íˆ¬ ë¬´ëŒ€ -->
    <section id="roomCard" class="card">
        <h2 id="roomName">ì•ˆë…• ! ë‚˜ëŠ” P.I.X.I.E(Personal Indexing eXfiltration Interface.)ì•¼! íƒì‚¬ë¥¼ ì‹œì‘í•˜ë ¤ë©´ ì¶”ì–µì´ ë‹´ê¸´ ì‚¬ì§„ì„ ë¶ˆëŸ¬ì™€ì¤˜!</h2>
        <p id="roomDesc">í•˜ë‹¨ì˜ â€œê¸°ì–µì„ ë¶ˆëŸ¬ì˜¤ê¸°â€ë¥¼ ëˆŒëŸ¬ íƒì‚¬ìë¥¼ ì†Œí™˜í•´ë³´ì!</p>
    </section>

    <!-- ì „íˆ¬ ë¬´ëŒ€ (í¬ì¼“ëª¬í˜•) -->
    <section id="battleStage" class="stage" hidden>
        <div id="battleBG" class="bg"></div>
        <div id="fxLayer" class="fx"></div>
        <div id="dmgFloats" class="floats"></div>

        <div class="side you">
            <img id="youSprite" alt="you">
            <div class="hp">
                <div id="hpYou" class="bar"></div>
                <span id="hpYouTxt">HP 0/0</span>
            </div>
        </div>

        <div class="side enemy">
            <img id="enemySprite" alt="enemy">
            <div class="hp">
                <div id="hpEnemy" class="bar"></div>
                <span id="hpEnemyTxt">HP 0/0</span>
            </div>
            <div id="enemyChips" class="chips"></div>
        </div>
    </section>

    <!-- ìŠ¤íƒ¯Â·íƒœê·¸ -->
    <section id="stats" class="stats"></section>
    <section id="tags" class="tags"></section>

    <!-- í•˜ë‹¨ ì•¡ì…˜ë°” -->
    <footer class="bottombar">
        <input id="fileInput" type="file" accept="image/*" hidden />
        <button id="mapDock" class="ghost">ì§€ë„</button>
        <button id="summonBtn">ê¸°ì–µì„ ë¶ˆëŸ¬ì˜¤ê¸°</button>
        <button id="attackBtn" class="primary" disabled>ê³µê²©</button>
        <button id="bagBtn" class="ghost">ê°€ë°©</button>
    </footer>

    <!-- â–¼â–¼â–¼ PIXIE ë§í’ì„  ë¡œê·¸ ì‹œíŠ¸ (êµì²´ë¨) â–¼â–¼â–¼ -->
    <aside id="logSheet" class="sheet" hidden aria-hidden="true" role="dialog" aria-label="PIXIE ë¡œê·¸">
        <div class="sheet-head" style="display:flex;align-items:center;justify-content:space-between;gap:8px;">
            <strong>PIXIE ëŒ€í™” ê¸°ë¡</strong>
            <button class="close" data-close="#logSheet" aria-label="ë‹«ê¸°">âœ•</button>
        </div>
        <!-- ë§í’ì„  ë¡œê·¸ ì˜ì—­ -->
        <div id="log" class="pixie-log" aria-live="polite" aria-atomic="false"></div>
    </aside>
    <!-- â–²â–²â–² PIXIE ë§í’ì„  ë¡œê·¸ ì‹œíŠ¸ â–²â–²â–² -->

    <!-- ë§µ ì˜¤ë²„ë ˆì´ -->
    <aside id="mapOverlay" class="overlay" hidden>
        <div class="overlay-inner">
            <div id="breadcrumb"></div>
            <div id="mapGraph"></div>
            <button class="close" data-close="#mapOverlay">ë‹«ê¸°</button>
        </div>
    </aside>

    <!-- ê°€ë°© ì‹œíŠ¸ (ì¥ë¹„/ì†Œëª¨/ìœ ë¬¼) -->
    <aside id="bagSheet" class="sheet" hidden>
        <!-- ìƒë‹¨ë°” + ë‹«ê¸° -->
        <div class="sheet-header">
            <strong>ê°€ë°©</strong>
            <button class="sheet-close" aria-label="ê°€ë°© ë‹«ê¸°" data-close="#bagSheet">âœ•</button>
        </div>

        <nav class="tabs">
            <button data-tab="equip" class="active">ì¥ë¹„</button>
            <button data-tab="consum">ì†Œëª¨í’ˆ</button>
            <button data-tab="relics">ìœ ë¬¼</button>
        </nav>

        <div id="equipSlots" class="panel"></div>
        <div id="itemsList" class="panel" hidden></div>
        <div id="relics" class="panel" hidden></div>
    </aside>
    <!-- ===== Vault Panel (ë°±ì—… ìºì‹œ ê¸ˆê³ ) ===== -->
    <div id="vaultSheet" class="sheet" hidden aria-hidden="true" role="dialog" aria-label="ë°±ì—… ìºì‹œ ê¸ˆê³ ">
        <div class="sheet-head" style="display:flex;align-items:center;justify-content:space-between;gap:8px;">
            <h3 style="margin:0;font-size:18px;">ë°±ì—… ìºì‹œ ê¸ˆê³ </h3>
            <button class="close" data-close="#vaultSheet" aria-label="ë‹«ê¸°">ë‹«ê¸°</button>
        </div>

        <div id="vaultList" class="shop-grid"
            style="display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:12px;margin-top:12px;">
            <!-- JSê°€ ì¹´ë“œ 3ê°œë¥¼ ì±„ì›€ -->
        </div>

        <div class="muted" style="margin-top:10px;font-size:12px;" id="vaultHint">
            1ê°œ ì„ íƒ (ë³´ìœ  Vault Keyë©´ 2ê°œ ì„ íƒ ê°€ëŠ¥). ì¬ë¡¤ 1íšŒ ê°€ëŠ¥.
        </div>

        <div style="margin-top:12px;display:flex;gap:8px;align-items:center;">
            <button id="vaultRerollBtn" class="ghost">ì¬ë¡¤(10G ë˜ëŠ” ì¡°ê° 1ê°œ)</button>
            <span class="tag" id="vaultPicksLeft">ë‚¨ì€ ì„ íƒ: 1</span>
            <span class="tag" id="vaultShards">ì¡°ê°: 0</span>
            <span class="tag" id="vaultKeys">Keys: 0</span>
        </div>
    </div>

    <!-- ===== Shop Panel (íŒ¨ì¹˜ í‚¤ì˜¤ìŠ¤í¬) ===== -->
    <div id="shopSheet" class="sheet" hidden aria-hidden="true">
        <div class="sheet-head" style="display:flex;align-items:center;justify-content:space-between;gap:8px;">
            <h3 style="margin:0;font-size:18px;">íŒ¨ì¹˜ í‚¤ì˜¤ìŠ¤í¬</h3>
            <button class="close" data-close="#shopSheet" aria-label="ë‹«ê¸°">ë‹«ê¸°</button>
        </div>

        <div id="shopList" class="shop-grid"
            style="display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:12px;margin-top:12px;">
            <!-- JSê°€ ì¹´ë“œ 3ê°œë¥¼ ì±„ì›€ -->
        </div>

        <div id="shopHint" class="muted" style="margin-top:10px;font-size:12px;">
            ê³¨ë“œëŠ” ìƒë‹¨ í‘œì‹œë¥¼ í™•ì¸í•˜ì„¸ìš”. íŒ¨ë„ì„ ë‹«ìœ¼ë©´ ë‹¤ìŒ ë°©ìœ¼ë¡œ ì§„í–‰í•©ë‹ˆë‹¤.
        </div>
    </div>

    <!-- ì‹œë“œ ì—…ë¡œë“œ íŒì—… 2ê°œ -->
    <dialog id="seedPopupA" hidden>
        <h3>ì‹œë“œ ë§¤í•‘ì‹¤ â€” ê²½ë¡œ ì‹œë“œ</h3>
        <p>ë‹¤ìŒ íŠ¸ë¦¬ì˜ ê²½ë¡œë¥¼ ì„¤ê³„ë¥¼ ë„ì™€ì¤„ ë„ˆì˜ ì£¼ë³€ ì‚¬ëŒì˜ ì‚¬ì§„ì„ ì—…ë¡œë“œí•´ì¤˜.</p>
        <input id="seedFileA" type="file" accept="image/*" />
        <menu>
            <button data-close="#seedPopupA">ì·¨ì†Œ</button>
            <button id="seedOkA">í™•ì •</button>
        </menu>
    </dialog>

    <dialog id="seedPopupB" hidden>
        <h3>ì‹œë“œ ë§¤í•‘ì‹¤ â€” í™˜ê²½ ì‹œë“œ</h3>
        <p>ì¸µì˜ ë¶„ìœ„ê¸°/ì´ë²¤íŠ¸ í™˜ê²½ì„ ì •í•  ë©‹ì§„ í’ê²½ ì‚¬ì§„ì„ ì—…ë¡œë“œí•´ì¤˜.</p>
        <input id="seedFileB" type="file" accept="image/*" />
        <menu>
            <button data-close="#seedPopupB">ì·¨ì†Œ</button>
            <button id="seedOkB">í™•ì •</button>
        </menu>
    </dialog>

    <!-- ëŒ€í™” íŒ¨ë„ -->
    <aside id="dialoguePanel" class="overlay" hidden>
        <div class="dialogue">
            <div id="dialogueLines"></div>
            <div id="choiceList" class="choices"></div>
            <button class="close" data-close="#dialoguePanel">ë‹«ê¸°</button>
        </div>
    </aside>

    <!-- ì¸íŠ¸ë¡œ ì˜¤ë²„ë ˆì´ -->
    <aside id="intro" class="intro" hidden aria-hidden="true">
        <div class="intro-wrap">
            <div class="scanlines"></div>
            <div class="noise"></div>

            <div class="badge">P.I.X.I.E / v0.1 boot</div>

            <h1 class="logo">
                <span class="type">P.I.X.I.E</span><span class="cursor">â–‹</span>
            </h1>
            <p class="subtitle">Personal&nbsp;Indexing&nbsp;eXfiltration&nbsp;Interface</p>

            <p class="hint">ì¶”ì–µ ì‹œê·¸ë‹ˆì²˜ í™•ì¸ ì¤‘â€¦</p>

            <button id="skipIntro" class="intro-skip">ê±´ë„ˆë›°ê¸°</button>
        </div>
    </aside>

    <!-- ë©”ì¸ ìŠ¤í¬ë¦½íŠ¸ -->
    <script src="./src/main.js"></script>

    <!-- (ì„ íƒ) PIXIE ë¡œê·¸ ë²„íŠ¼ í† ê¸€ë§Œ ë³´ì¡°: main.jsê°€ ì´ë¯¸ ì²˜ë¦¬ ì¤‘ì´ë©´ ìƒëµí•´ë„ OK -->
    <script>
        (function () {
            const btn = document.getElementById('pixieBtn');
            const sheet = document.getElementById('logSheet');
            if (!btn || !sheet) return;
            btn.addEventListener('click', () => {
                const isHidden = sheet.hasAttribute('hidden');
                if (isHidden) {
                    sheet.hidden = false;
                    sheet.removeAttribute('aria-hidden');
                    btn.setAttribute('aria-expanded', 'true');
                } else {
                    sheet.setAttribute('hidden', '');
                    sheet.setAttribute('aria-hidden', 'true');
                    btn.setAttribute('aria-expanded', 'false');
                }
            });
        }());
    </script>
    <!-- â–¼ PIXIE ìŠ¤í† ë¦¬ ë§í’ì„ (ë¡œê·¸ì™€ ë³„ê°œ) -->
    <aside id="storyBubble" class="story-bubble" hidden aria-hidden="true" aria-live="polite">
        <div class="bubble">
            <div class="pixie-badge">P.I.X.I.E</div>
            <p id="storyText">...</p>
            <button id="storyClose" class="ghost" title="ë‹«ê¸°">ë‹«ê¸°</button>
        </div>
    </aside>
    <script src="./src/story-bubble.js"></script>

</body>

</html>